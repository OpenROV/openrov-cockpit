<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../orov-behaviors/orov-behavior.html">
<dom-module name="orov-battery-status" >
<style>
.battery0 {
    background: #ffffff;
}

#batteryIndicator{
    width:50px;
    height: 22px;
    background-image: url(data:image/png;base64,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);
    background-repeat:no-repeat;
    background-position:0px 0px;
}

#batteryIndicator.level1 {
    background-position:0px 0px;
}

#batteryIndicator.level2 {
    background-position: 0px -24px;
}

#batteryIndicator.level3 {
    background-position: 0px -49px;
}

#batteryIndicator.level4 {
    background-position:0px -73px;
}

#batteryIndicator.level5 {
    background-position:0px -96px;
}

</style>
  <template>
    <div id="batteryIndicator" class$="{{computedLevelClass(voltage)}}" ></div>
  </template>
  <script>
    (function() {
      var orovbehaviors = namespace('behaviors');
      Polymer({
        is: 'orov-battery-status',
        properties: {
          minVoltage: {type: Number, value:0},
          maxVoltage: {type: Number, value:0},
          voltage: {type: Number, value:0}
        },
        behaviors: [orovbehaviors.oROVStandard],
        computedLevelClass : function(voltage){
          var change = (this.maxVoltage - this.minVoltage) / (voltage - this.minVoltage);
          var percentage = 100 / change;
          var indicatorWidth = 5 / change;
          indicatorWidth = indicatorWidth.toFixed(0);

          return 'level'+(indicatorWidth);
        },
        registerEmitterHanlders: function(emitter) {
          var self = this;

          emitter.on('plugin.controllerboard2x.systemPower.update', function(data){
              if ('voltage' in data.board){
                this.voltage = Number(data.board.voltage);
              };
          });


          emitter.withHistory.on('settings-change.batteryDefintions', function(settings){
            var selectedBattery = settings.batteryDefintions.selectedBattery;
            var definition = settings.batteryDefintions.batteries.find(function(element,index,array){
              if(element.name == selectedBattery) return true;
              return false;
            });
            if (definition!==undefined){
              self.minVoltage = definition.minVoltage;
              self.maxVoltage = definition.maxVoltage;
            }
          });
        }

        });
      })();
  </script>

</dom-module>
