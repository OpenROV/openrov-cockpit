<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../orov-behaviors/orov-behavior.html">
<link rel="import" href="orov-horizon-behavior.html">
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">

<dom-module id="orov-horizon-test">
  <style type="text/css">
      .hidden { display: none }
      .horizon {
          width:100%;
          height:100%;
          position:absolute;
          top:0px;
          left:0px;
      }
      #ai-container {
        position: absolute;
        top:0;
        bottom: 0;
        left: 0;
        right: 0;

        margin: auto;
      }
      #hud-container {
        position: absolute;
        top:0;
        bottom: 0;
        left: 0;
        right: 0;

        margin: auto;
      }
      #crosshair-container {
        width: 50%;
        margin: auto;
      }

      #crosshair {
        x: -159px;
        y: 57px;

        translate3d(0,0,0);
        transition-duration: 0.50s;
        transformation-timing-function: ease-out;
      }
            
      #svg2 {
        position: absolute;
        top:0;
        bottom: 0;
        left: 0;
        right: 0;

        margin: auto;
      }

    </style>
  <template>
  <svg height="35%"
   xmlns:osb="http://www.openswatchbook.org/uri/2009/osb"
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="165.07928"
   height="439.92352"
   viewBox="0 0 165.07919 439.92344"
   id="svg2"
   version="1.1"
   inkscape:version="0.91 r13725"
   sodipodi:docname="contrast-hud.svg"
   inkscape:export-filename="/home/gilbert/workspace/openrov-dev/assets/30.0.1_UI/heads-up-display.svg.png"
   inkscape:export-xdpi="90"
   inkscape:export-ydpi="90">
  <defs
     id="defs4">
    <linearGradient
       id="linearGradient11197"
       osb:paint="solid">
      <stop
         style="stop-color:#ffffff;stop-opacity:1;"
         offset="0"
         id="stop11199" />
    </linearGradient>
    <linearGradient
       id="linearGradient9337"
       osb:paint="solid">
      <stop
         style="stop-color:#000000;stop-opacity:1;"
         offset="0"
         id="stop9339" />
    </linearGradient>
    <linearGradient
       id="linearGradient8718"
       osb:paint="solid">
      <stop
         style="stop-color:#000000;stop-opacity:1;"
         offset="0"
         id="stop8720" />
    </linearGradient>
    <linearGradient
       id="linearGradient7432"
       osb:paint="solid">
      <stop
         style="stop-color:#ab5d33;stop-opacity:1;"
         offset="0"
         id="stop7434" />
    </linearGradient>
    <marker
       inkscape:stockid="Arrow1Lend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow1Lend"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path4261"
         d="M 0,0 5,-5 -12.5,0 5,5 0,0 Z"
         style="fill:#ab5d33;fill-opacity:1;fill-rule:evenodd;stroke:#f8a33f;stroke-width:1pt;stroke-opacity:1"
         transform="matrix(-0.8,0,0,-0.8,-10,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8447">
      <rect
         style="opacity:1;fill:#f8a33f;fill-opacity:1;stroke:#f8a33f;stroke-width:7.21339846;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8449"
         width="69.054459"
         height="15.393744"
         x="97.21376"
         y="677.43341" />
    </clipPath>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8447-5">
      <rect
         style="opacity:1;fill:#f8a33f;fill-opacity:1;stroke:#f8a33f;stroke-width:7.21339846;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8449-6"
         width="69.054459"
         height="15.393744"
         x="97.21376"
         y="677.43341" />
    </clipPath>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8474">
      <rect
         style="opacity:1;fill:none;fill-opacity:1;stroke:#f8a33f;stroke-width:7.43066835;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8476"
         width="49.462189"
         height="151.89294"
         x="170.12877"
         y="508.94791" />
    </clipPath>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8474-9">
      <rect
         style="opacity:1;fill:none;fill-opacity:1;stroke:#f8a33f;stroke-width:7.43066835;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8476-1"
         width="49.462189"
         height="151.89294"
         x="170.12877"
         y="508.94791" />
    </clipPath>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8447-5-7">
      <rect
         style="opacity:1;fill:#f8a33f;fill-opacity:1;stroke:#f8a33f;stroke-width:7.21339846;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8449-6-0"
         width="69.054459"
         height="15.393744"
         x="97.21376"
         y="677.43341" />
    </clipPath>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8447-5-7-6">
      <rect
         style="opacity:1;fill:#f8a33f;fill-opacity:1;stroke:#f8a33f;stroke-width:7.21339846;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8449-6-0-2"
         width="69.054459"
         height="15.393744"
         x="97.21376"
         y="677.43341" />
    </clipPath>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8447-5-6">
      <rect
         style="opacity:1;fill:#f8a33f;fill-opacity:1;stroke:#f8a33f;stroke-width:7.21339846;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8449-6-1"
         width="69.054459"
         height="15.393744"
         x="97.21376"
         y="677.43341" />
    </clipPath>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8447-5-9">
      <rect
         style="opacity:1;fill:#f8a33f;fill-opacity:1;stroke:#f8a33f;stroke-width:7.21339846;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8449-6-2"
         width="69.054459"
         height="15.393744"
         x="97.21376"
         y="677.43341" />
    </clipPath>
    <clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath8447-5-9-2">
      <rect
         style="opacity:1;fill:#f8a33f;fill-opacity:1;stroke:#f8a33f;stroke-width:7.21339846;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="rect8449-6-2-3"
         width="69.054459"
         height="15.393744"
         x="97.21376"
         y="677.43341" />
    </clipPath>
  </defs>
  <sodipodi:namedview
     id="base"
     pagecolor="#3361aa"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="1"
     inkscape:pageshadow="2"
     inkscape:zoom="1.4142136"
     inkscape:cx="-39.637112"
     inkscape:cy="413.00629"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="true"
     inkscape:snap-object-midpoints="false"
     inkscape:snap-to-guides="true"
     inkscape:snap-bbox="true"
     inkscape:window-width="2495"
     inkscape:window-height="1416"
     inkscape:window-x="65"
     inkscape:window-y="24"
     inkscape:window-maximized="1"
     fit-margin-top="-0.2"
     units="px"
     showguides="false"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0">
    <inkscape:grid
       type="xygrid"
       id="grid3369"
       originx="-487.70878"
       originy="-29.786798" />
  </sodipodi:namedview>
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     style="display:inline"
     transform="translate(-487.70894,-582.65205)">
    <rect
       style="opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.67693496;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect11121"
       width="139.10703"
       height="1.3230646"
       x="498.92511"
       y="593.21338" />
    <rect
       style="display:inline;opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.67693549;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect11121-9"
       width="139.10724"
       height="1.3230641"
       x="498.92499"
       y="1011.5894" />
    <rect
       style="display:inline;opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.35726765;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect11121-2"
       width="44.864475"
       height="1.142732"
       x="546.04639"
       y="697.89752" />
    <rect
       style="display:inline;opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.35726768;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect11121-2-2"
       width="44.864468"
       height="1.1427319"
       x="546.04639"
       y="907.08557" />
    <ellipse
       style="display:inline;opacity:1;fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:2.95565796;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="path8517"
       cx="569.98535"
       cy="801.9942"
       transform="matrix(0.99999824,0.00187749,-0.00187749,0.99999824,0,0)"
       rx="7.5221686"
       ry="7.5221696" />
    <rect
       style="display:inline;opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.40966639;stroke-linejoin:round;stroke-opacity:1"
       id="rect11102-5-1"
       width="44.596321"
       height="1.5903331"
       x="516.77246"
       y="798.26776" />
    <rect
       style="display:inline;opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.4099999;stroke-linejoin:round;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-linecap:butt"
       id="rect11102-5-1-2"
       width="44.596321"
       height="1.5903331"
       x="516.77246"
       y="806.01398" />
    <rect
       style="display:inline;opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.40966648;stroke-linejoin:round;stroke-opacity:1"
       id="rect11102-5-1-9"
       width="44.596321"
       height="1.590333"
       x="575.20874"
       y="798.26733" />
    <rect
       style="display:inline;opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.40966651;stroke-linejoin:round;stroke-opacity:1"
       id="rect11102-5-1-2-3"
       width="44.596321"
       height="1.590333"
       x="575.2088"
       y="806.00433" />
    <rect
       style="opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.34534296;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect12213"
       width="1.6546565"
       height="201.65463"
       x="567.65131"
       y="811.40137" />
    <rect
       style="display:inline;opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.34534299;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect12213-1"
       width="1.6546565"
       height="201.6546"
       x="567.65131"
       y="593.08734" />
  </g>
    <g id="crosshair"
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-158.18984,-303.87297)">
    <circle
       style="display:inline;opacity:1;fill:#b71c1c;fill-opacity:1;stroke:#ffffff;stroke-width:1.47782898;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="path8517"
       cx="185.61319"
       cy="308.02502"
       r="3.7610855"
       transform="matrix(0.99999824,0.00187749,-0.00187749,0.99999824,0,0)" />
    <rect
       style="opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.30686828;stroke-linejoin:round;stroke-opacity:1"
       id="rect11102-5"
       width="22.193132"
       height="1.7931317"
       x="158.34328"
       y="307.47641" />
    <rect
       style="opacity:1;fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.30686828;stroke-linejoin:round;stroke-opacity:1"
       id="rect11102-5-8"
       width="22.193132"
       height="1.7931317"
       x="189.54305"
       y="307.47641" />
      </g>
      </svg>
    </div>
    </div>
  </template>

  <script>
      var map = function (value, in_min, in_max, out_min, out_max) {
        return (value - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
       };
      (function () {    
      Polymer({
        is: 'orov-horizon-test',
        properties: {
          pitchValue: {
            type: Number,
            value: 0
          }
        },
        behaviors: [namespace('behaviors').oROVStandard],
        setData: function (data) {
          var self = this;
          if(!jQuery.isEmptyObject(data)) {
            requestAnimationFrame(function() {
              self.render(data);
            })
          }
        },
        registerEmitterHandlers: function(emitter){
          var self = this;
          var lastData = null;

          emitter.on('plugin.navigationData.data', function(data){
            if(lastData == data) {return};
            lastData = data;
          });
          var updateData = function(){
            self.setData(lastData);
            setTimeout(updateData.bind(self),1000);
          }
          updateData();
        },
        attached: function () {
          this.roll = 0;
          this.pitch = 0;

          var self = this;

          this.draw();
        },
        render: function (data) {
          this.setValues({
            roll: data.roll * Math.PI / 180,
            pitch: data.pitch,
          });
          this.draw();
        },
        setValues: function setValues(values) {
          this.roll = values.roll;
          this.pitch = values.pitch;
        },
        draw: function draw() {
          this.pitch *= Math.floor(Math.random()*2) == 1 ? 1 : -1;
          var yPos = map(this.pitch, -90, 90, -287, 112);
          
          this.$.crosshair.style.transform = "translate3d(-104px," + yPos + "px, 0px)";
          
        }
      });
    }());
  </script>
</dom-module>
        
        